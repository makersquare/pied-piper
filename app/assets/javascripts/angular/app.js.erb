// This is the main Angular application page.
// The Config function is run before the injector and before the RUN function
//  The run function is run after the config function.
//  An example of this is the config provides a route while the run function
// provides user authentication for the routes.

var app = angular
  .module('crmApp', [
    'ngResource',
    'ngRoute',
  ]);

  // Inject necessary dependencies inside of this function below
  app.config(['$routeProvider',function($routeProvider){
  //providers second
  $routeProvider
    .when('/pipelines', {
      templateUrl: "<%= asset_path('angular/templates/pipelines.html') %>",
      controller: 'PipelinesStatusCtrl'
    })
    .when('/pipeline/:id', {
      templateUrl: "<%= asset_path('angular/templates/pipeline_details.html') %>",
      controller: 'PipelineDetailsCtrl'
    })
    .when('/pipeline/:pid/contact/:cid', {
      templateUrl: "<%= asset_path('angular/templates/contact_box.html') %>",
      controller: 'ContactBoxCtrl'
    })
    .when('/pipeline/:pipeline_id/fields', {
      templateUrl: "<%= asset_path('angular/templates/createFields.html') %>",
      controller: 'CreateFieldsCtrl'
    })
    .when('/email_settings/:user_id', {
      templateUrl: "<%= asset_path('angular/templates/account_settings.html') %>",
      controller: 'EmailCtrl'
    })
    .when('/pipeline/:pipeline_id/stages', {
      templateUrl: "<%= asset_path('angular/templates/createFields.html') %>",
      controller: 'StagesCtrl'
    })
    .when('/contacts', {
      templateUrl: "<%= asset_path('angular/templates/contacts.html') %>",
      controller: 'ContactsCtrl'
    })
    .otherwise({
      redirectTo: '/pipelines'
    })
}])

.run(function(){
// User authentication should go here
// When the angular route is changed the ng event
// $routeChangeSuccess OR $routeChangeError is fired

});

// This is our services Module for API calls
// var service = angular.module("apiService", ["ngResource"]);
